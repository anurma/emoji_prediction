import codecs
from bs4 import BeautifulSoup
import re
import pandas as pd
import numpy as np
import emoji


def explode(df, lst_cols, fill_value=''):
     if lst_cols and not isinstance(lst_cols, list):
        lst_cols = [lst_cols]
    idx_cols = df.columns.difference(lst_cols)
    lens = df[lst_cols[0]].str.len()

    if (lens > 0).all():
        return pd.DataFrame({
            col:np.repeat(df[col].values, lens)
            for col in idx_cols
        }).assign(**{col:np.concatenate(df[col].values) for col in lst_cols}) \
          .loc[:, df.columns]
    else:
        return pd.DataFrame({
            col:np.repeat(df[col].values, lens)
            for col in idx_cols
        }).assign(**{col:np.concatenate(df[col].values) for col in lst_cols}) \
          .append(df.loc[lens==0, idx_cols]).fillna(fill_value) \
          .loc[:, df.columns]

def extract_emojis(str):
    return ''.join(c for c in str if c in emoji.UNICODE_EMOJI)

#list with all messages from mdk chat
test = [r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages2.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages3.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages4.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages5.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages6.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages7.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages8.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages9.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages10.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages11.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages12.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages13.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages14.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages15.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages16.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages17.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages18.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages19.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages20.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages21.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages22.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages23.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages24.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages25.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages26.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages27.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages28.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages29.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages30.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages31.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages32.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages33.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages34.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages35.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages36.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages37.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages38.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages39.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages40.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages41.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages42.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages43.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages44.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages45.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages46.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages47.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages48.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages49.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages50.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages51.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages52.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages53.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages54.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages55.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages56.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages57.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages58.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages59.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages60.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages61.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages62.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages63.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages64.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages65.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages66.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages67.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages68.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages69.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages70.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages71.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages72.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages73.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages74.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages75.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages76.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages77.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages78.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages79.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages80.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages81.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages82.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages83.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages84.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages85.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages86.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages87.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages88.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages89.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages90.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages91.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages92.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages93.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages94.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages95.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages96.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages97.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages98.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages99.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages100.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages101.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages102.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages103.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages104.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages105.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages106.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages107.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages108.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages109.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages110.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages111.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages112.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages113.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages114.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages115.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages116.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages117.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages118.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages119.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages120.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages121.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages122.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages123.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages124.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages125.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages126.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages127.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages128.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages129.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages130.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages131.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages132.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages133.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages134.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages135.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages136.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages137.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages138.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages139.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages140.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages141.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages142.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages143.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages144.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages145.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages146.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages147.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages148.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages149.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages150.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages151.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages152.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages153.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages154.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages155.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages156.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages157.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages158.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages159.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages160.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages161.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages162.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages163.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages164.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages165.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages166.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages167.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages168.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages169.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages170.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages171.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages172.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages173.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages174.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages175.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages176.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages177.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages178.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages179.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages180.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages181.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages182.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages183.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages184.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages185.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages186.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages187.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages188.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages189.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages190.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages191.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages192.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages193.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages194.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages195.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages196.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages197.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages198.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages199.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages200.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages201.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages202.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages203.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages204.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages205.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages206.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages207.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages208.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages209.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages210.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages211.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages212.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages213.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages214.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages215.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages216.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages217.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages218.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages219.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages220.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages221.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages222.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages223.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages224.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages225.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages226.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages227.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages228.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages229.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages230.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages231.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages232.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages233.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages234.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages235.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages236.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages237.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages238.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages239.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages240.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages241.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages242.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages243.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages244.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages245.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages246.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages247.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages248.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages249.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages250.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages251.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages252.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages253.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages254.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages255.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages256.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages257.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages258.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages259.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages260.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages261.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages262.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages263.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages264.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages265.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages266.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages267.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages268.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages269.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages270.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages271.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages272.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages273.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages274.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages275.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages276.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages277.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages278.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages279.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages280.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages281.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages282.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages283.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages284.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages285.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages286.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages287.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages288.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages289.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages290.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages291.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages292.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages293.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages294.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages295.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages296.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages297.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages298.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages299.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages300.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages301.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages302.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages303.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages304.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages305.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages306.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages307.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages308.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages309.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages310.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages311.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages312.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages313.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages314.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages315.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages316.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages317.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages318.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages319.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages320.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages321.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages322.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages323.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages324.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages325.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages326.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages327.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages328.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages329.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages330.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages331.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages332.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages333.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages334.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages335.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages336.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages337.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages338.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages339.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages340.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages341.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages342.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages343.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages344.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages345.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages346.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages347.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages348.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages349.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages350.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages351.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages352.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages353.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages354.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages355.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages356.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages357.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages358.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages359.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages360.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages361.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages362.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages363.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages364.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages365.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages366.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages367.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages368.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages369.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages370.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages371.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages372.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages373.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages374.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages375.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages376.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages377.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages378.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages379.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages380.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages381.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages382.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages383.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages384.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages385.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages386.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages387.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages388.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages389.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages390.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages391.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages392.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages393.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages394.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages395.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages396.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages397.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages398.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages399.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages400.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages401.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages402.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages403.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages404.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages405.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages406.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages407.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages408.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages409.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages410.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages411.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages412.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages413.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages414.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages415.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages416.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages417.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages418.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages419.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages420.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages421.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages422.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages423.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages424.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages425.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages426.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages427.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages428.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages429.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages430.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages431.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages432.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages433.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages434.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages435.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages436.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages437.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages438.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages439.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages440.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages441.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages442.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages443.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages444.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages445.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages446.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages447.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages448.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages449.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages450.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages451.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages452.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages453.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages454.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages455.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages456.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages457.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages458.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages459.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages460.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages461.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages462.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages463.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages464.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages465.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages466.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages467.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages468.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages469.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages470.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages471.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages472.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages473.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages474.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages475.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages476.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages477.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages478.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages479.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages480.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages481.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages482.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages483.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages484.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages485.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages486.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages487.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages488.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages489.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages490.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages491.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages492.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages493.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages494.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages495.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages496.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages497.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages498.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages499.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages500.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages501.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages502.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages503.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages504.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages505.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages506.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages507.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages508.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages509.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages510.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages511.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages512.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages513.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages514.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages515.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages516.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages517.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages518.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages519.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages520.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages521.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages522.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages523.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages524.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages525.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages526.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages527.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages528.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages529.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages530.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages531.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages532.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages533.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages534.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages535.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages536.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages537.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages538.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages539.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages540.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages541.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages542.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages543.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages544.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages545.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages546.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages547.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages548.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages549.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages550.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages551.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages552.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages553.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages554.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages555.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages556.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages557.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages558.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages559.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages560.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages561.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages562.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages563.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages564.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages565.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages566.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages567.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages568.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages569.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages570.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages571.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages572.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages573.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages574.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages575.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages576.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages577.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages578.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages579.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages580.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages581.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages582.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages583.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages584.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages585.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages586.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages587.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages588.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages589.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages590.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages591.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages592.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages593.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages594.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages595.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages596.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages597.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages598.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages599.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages600.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages601.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages602.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages603.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages604.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages605.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages606.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages607.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages608.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages609.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages610.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages611.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages612.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages613.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages614.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages615.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages616.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages617.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages618.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages619.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages620.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages621.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages622.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages623.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages624.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages625.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages626.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages627.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages628.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages629.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages630.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages631.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages632.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages633.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages634.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages635.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages636.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages637.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages638.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages639.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages640.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages641.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages642.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages643.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages644.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages645.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages646.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages647.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages648.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages649.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages650.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages651.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages652.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages653.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages654.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages655.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages656.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages657.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages658.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages659.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages660.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages661.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages662.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages663.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages664.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages665.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages666.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages667.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages668.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages669.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages670.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages671.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages672.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages673.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages674.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages675.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages676.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages677.html',r'C:\Users\USER\Documents\ChatExport_22_12_2018\messages678.html']


mdk_final = pd.DataFrame(columns=['date', 'message', 'user', 'emoji', 'text_before_emoji'])

#extracting info from htmls

for i in test:
    print(i)
    f=codecs.open(i, 'r','utf-8').read()
    user_messages = f.split('div class="from_name"')
    user_messages = user_messages[1:]

    #extracting users
    pattern = re.compile(r'\n(.*?)\n')
    users = [ m.group(1) for m in (pattern.search(line) for line in user_messages) if m ]

    #extracting messages
    messages = []
    for i in range(len(user_messages)):
        mes = re.findall('class="text"(.*?)</div', user_messages[i], re.S)
        messages.append(mes)

    #extracting dates
    date = []
    for i in range(len(user_messages)):
        dat = re.findall('<div class="pull_right date details" title="(.*?)">', user_messages[i], re.S)
        date.append(dat)
    
    #exracting the first date for a user
    date_f = []
    for i in range(len(date)):
        dd = next(iter(date[i] or []), None)
        date_f.append(dd)

    mdk = pd.DataFrame(
        {'date': date_f,
        'message': messages,
        'user': users})

    mdk = mdk[mdk.astype(str)['message'] != '[]']

    mdk_f = explode(mdk, ['message'], fill_value='')

    mdk_f['message'] = mdk_f['message'].replace(r'\n',' ', regex=True).replace(r'>\s',' ', regex=True)
    mdk_f['message'] = [x.strip() for x in mdk_f['message']]
    mdk_f['emoji'] = [extract_emojis(x) for x in mdk_f.message]

    mdk_with_emojis = mdk_f[mdk_f['emoji'] != '']
    mdk_with_emojis = mdk_with_emojis.reset_index()

    #extracting text before emoji
    bb = []
    for i in range(len(mdk_with_emojis)) :
        text = mdk_with_emojis['message'][i].split(mdk_with_emojis['emoji'][i])[0]
        bb.append(text)
    mdk_with_emojis['text_before_emoji']  = bb
#     mdk_with_emojis['emoji'] = [x.encode('unicode-escape') for x in mdk_with_emojis['emoji']]
    mdk_final = mdk_final.append(mdk_with_emojis)

mdk_final = mdk_final.reset_index(drop = True)

#a function to create a long table with a single emoji as a column
def get_emoji_col(df, col):
    import emoji
    import re
    emoji_col = []
    df[col] = df[col].astype(str)
    emojis_list = map(lambda x: ''.join(x.split()), emoji.UNICODE_EMOJI.keys())
    r = re.compile('|'.join(re.escape(p) for p in emojis_list))
    for i in range(len(df)):
        emoji_col.append(','.join(r.findall(str(df[col][i]))).split(","))
    df['emoji'] = emoji_col
    s = df.apply(lambda x: pd.Series(x['emoji']), axis=1).stack().reset_index(level=1, drop=True)
    s.name = 'emoji' 
    df2 = df.drop('emoji', axis=1).join(s)
    df2['emoji'] = pd.Series(df2['emoji'], dtype=object)
    return df2


df_all = get_emoji_col(mdk_final, 'message')

df_all1 = df_all.copy()

#cleaning data
df_all1 = df_all1.replace({'\n': ' ', '<strong>': ' ', '</strong>': ' ', '<br>':' ', '<em>': ' ', '</em>': ' '}, regex=True)
df_all1 = df_all1.replace({'http[^[:space:]]*': ' '}, regex=True)
df_all1 = df_all1.replace({'<a href="': ' ', '</em': ' '}, regex=True)
df_all1 = df_all1.replace({'@[a-zA-Z0-9_]+': '@username'}, regex=True)
df_all1 = df_all1.replace({'\s+': ' '}, regex=True)
df_all1['channel'] = 'mdk'

df_all1.to_csv(r'C:\Users\USER\Desktop\mdk.csv', encoding='utf-8')

